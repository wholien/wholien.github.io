<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author" content="Julien Chien ">
<meta name="description" content="For around two and a half years, I had been working in a Python 2.x environment at my old job . Since switching companies, Ruby and Rails has replaced Python and Flask. At first glance, the languages don&amp;rsquo;t seem super different, but there are definitely common Ruby idioms that I needed to learn.
While adding a new feature, I came across code that looked like this:
if (variable = some_func()) do_something(variable) end Intuitively, I guessed this meant &amp;ldquo;if some_func() returns something, do_something with it." />
<meta name="keywords" content=", ruby, programming, python" />
<meta name="robots" content="noodp" />
<meta name="theme-color" content="" />
<link rel="canonical" href="https://julienchien.com/posts/assignments-in-conditional-expressions/" />


    <title>
        
            Ruby Assignments in Conditional Expressions :: Julien &#39;I break websites&#39; Chien 
        
    </title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="/main.min.753fac8f03736f0edc9be411eb20cee875dd7bb8e73c8155fbf6a629c863f4ca.css">






<meta itemprop="name" content="Ruby Assignments in Conditional Expressions">
<meta itemprop="description" content="For around two and a half years, I had been working in a Python 2.x environment at my old job . Since switching companies, Ruby and Rails has replaced Python and Flask. At first glance, the languages don&rsquo;t seem super different, but there are definitely common Ruby idioms that I needed to learn.
While adding a new feature, I came across code that looked like this:
if (variable = some_func()) do_something(variable) end Intuitively, I guessed this meant &ldquo;if some_func() returns something, do_something with it.">
<meta itemprop="datePublished" content="2020-05-10T15:36:21-07:00" />
<meta itemprop="dateModified" content="2020-05-10T15:36:21-07:00" />
<meta itemprop="wordCount" content="497">
<meta itemprop="image" content="https://julienchien.com"/>



<meta itemprop="keywords" content="ruby,programming,python," />
<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://julienchien.com"/>

<meta name="twitter:title" content="Ruby Assignments in Conditional Expressions"/>
<meta name="twitter:description" content="For around two and a half years, I had been working in a Python 2.x environment at my old job . Since switching companies, Ruby and Rails has replaced Python and Flask. At first glance, the languages don&rsquo;t seem super different, but there are definitely common Ruby idioms that I needed to learn.
While adding a new feature, I came across code that looked like this:
if (variable = some_func()) do_something(variable) end Intuitively, I guessed this meant &ldquo;if some_func() returns something, do_something with it."/>







    <meta property="article:published_time" content="2020-05-10 15:36:21 -0700 PDT" />








    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">/julienchien/posts</span>
            <span class="logo__cursor" style=
                  "
                   
                   ">
            </span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://julienchien.com/about">About</a></li><li><a href="https://julienchien.com/posts">Blog</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>3 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title">
                <a href="https://julienchien.com/posts/assignments-in-conditional-expressions/">Ruby Assignments in Conditional Expressions</a>
            </h1>

            

            <div class="post-content">
                <p>For around two and a half years, I had been working in a Python 2.x environment at my <a href="https://www.linkedin.com/in/julienchien/" target="_blank">old job</a>
. Since switching companies, Ruby and Rails has replaced Python and Flask. At first glance, the languages don&rsquo;t seem super different, but there are definitely common Ruby idioms that I needed to learn.</p>
<p>While adding a new feature, I came across code that looked like this:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#66d9ef">if</span> (variable <span style="color:#f92672">=</span> some_func())
  do_something(variable)
<span style="color:#66d9ef">end</span>
</code></pre></div><p>Intuitively, I guessed this meant &ldquo;if <code>some_func()</code> returns something, <code>do_something</code> with it.&rdquo; What took a second was understanding that you could do an assignment conditional expressions.</p>
<h4 id="coming-from-python">Coming from Python</h4>
<p>In Python 2.x land (and any Python 3 before 3.8), assigning a variable in a conditional expression would return a syntax error:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">def</span> <span style="color:#a6e22e">some_func</span>(): <span style="color:#66d9ef">return</span> <span style="color:#ae81ff">42</span>;
<span style="color:#f92672">.</span><span style="color:#f92672">.</span><span style="color:#f92672">.</span>
<span style="color:#f92672">&gt;&gt;</span><span style="color:#f92672">&gt;</span> <span style="color:#66d9ef">if</span> (a <span style="color:#f92672">=</span> some_func())
  File <span style="color:#e6db74"></span><span style="color:#e6db74">&#34;</span><span style="color:#e6db74">&lt;stdin&gt;</span><span style="color:#e6db74">&#34;</span>, line <span style="color:#ae81ff">1</span>
    <span style="color:#66d9ef">if</span> (a <span style="color:#f92672">=</span> some_func())
          <span style="color:#f92672">^</span>
<span style="color:#a6e22e">SyntaxError</span>: invalid syntax
</code></pre></div><p>Most likely, the assignment in a conditional expression is a typo where the programmer meant to do a comparison <code>==</code> instead.</p>
<p>This kind of typo is a big enough issue that there is a programming style called <a href="https://en.wikipedia.org/wiki/Yoda_conditions" target="_blank">Yoda Conditionals</a>
, where the constant portion of a comparison is put on the left side of the operator. This would cause a syntax error if <code>=</code> were used instead of <code>==</code>, like this:</p>
<pre><code>if (42 = x)
  ...
</code></pre><h4 id="back-to-ruby">Back to Ruby</h4>
<p>Now that I&rsquo;ve come across this kind of assignment in Ruby for the first time, I searched whether assignments in conditional expressions were good style. Sure enough, the <a href="https://rubystyle.guide/" target="_blank">Ruby Style Guide</a>
 has a section called <a href="https://rubystyle.guide/#safe-assignment-in-condition" target="_blank">&ldquo;Safe Assignment in Condition&rdquo;</a>
. The section and examples are short and straightforward. You should take a look if this Ruby idiom is new to you!</p>
<p>What is interesting about this idiom is that the assignment should be wrapped in parentheses. Take a look at the examples from the Ruby Style Guide:</p>
<div class="highlight"><pre style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-ruby" data-lang="ruby"><span style="color:#75715e"># bad (+ a warning)</span>
<span style="color:#66d9ef">if</span> v <span style="color:#f92672">=</span> array<span style="color:#f92672">.</span>grep(<span style="color:#e6db74">/</span><span style="color:#e6db74">foo</span><span style="color:#e6db74">/</span>)
  do_something(v)
  <span style="color:#75715e"># some code</span>
<span style="color:#66d9ef">end</span>

<span style="color:#75715e"># good (MRI would still complain, but RuboCop won&#39;t)</span>
<span style="color:#66d9ef">if</span> (v <span style="color:#f92672">=</span> array<span style="color:#f92672">.</span>grep(<span style="color:#e6db74">/</span><span style="color:#e6db74">foo</span><span style="color:#e6db74">/</span>))
  do_something(v)
  <span style="color:#75715e"># some code</span>
<span style="color:#66d9ef">end</span>
</code></pre></div><p>Why is the first example bad? Well, the Style Guide also says that you <a href="https://rubystyle.guide/#no-parens-around-condition" target="_blank">shouldn&rsquo;t put parentheses around conditional expressions</a>
. Parentheses around assignments in conditional expressions are specifically called out as an exception to this rule.</p>
<p>My guess is that by enforcing two different conventions, one for pure conditionals and one for assignments in conditionals, the onus is now on the programmer to decide what they want to do. This should prevent typos where an assignment <code>=</code> is used when a comparison <code>==</code> was intended, or vice versa.</p>
<h4 id="the-python-equivalent">The Python Equivalent</h4>
<p>As called out above, assignments in conditional expressions are possible in Python 3.8 via <a href="https://www.python.org/dev/peps/pep-0572/" target="_blank">PEP 572</a>
. Instead of using an <code>=</code> for these kinds of assignments, the PEP introduced a new operator <code>:=</code>. As parentheses are more common in Python expressions, introducing a new operator <code>:=</code> (informally known as &ldquo;the walrus operator&rdquo;!!) was probably Python&rsquo;s solution to the typo issue.</p>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://julienchien.com/tags/ruby">ruby</a></span><span class="tag"><a href="https://julienchien.com/tags/programming">programming</a></span><span class="tag"><a href="https://julienchien.com/tags/python">python</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>497 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2020-05-10 15:36 -0700</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h">Read other posts</span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    
                        <span class="button previous">
                            <a href="https://julienchien.com/posts/post-pandemic-work-life/">
                                <span class="button__icon">←</span>
                                <span class="button__text">Post-Pandemic Work Life: Going Into Work Once Per Week</span>
                            </a>
                        </span>
                    

                    
                        <span class="button next">
                            <a href="https://julienchien.com/posts/hello/">
                                <span class="button__text">Hello World!</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2020</span>
            
                <span><a href="https://julienchien.com">Julien Chien</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="https://julienchien.com/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="/bundle.min.4a69500057d68129e88f497d354afe68422eb56de6d15e45dbe2190858ea5a76bfcb096406f992984b241db45f47388ac57ab0376e3b32125bef7a8a6d0f06c4.js" integrity="sha512-SmlQAFfWgSnoj0l9NUr&#43;aEIutW3m0V5F2&#43;IZCFjqWna/ywlkBvmSmEskHbRfRziKxXqwN247MhJb73qKbQ8GxA=="></script>
    
<script type="application/javascript">
var doNotTrack = false;
if (!doNotTrack) {
	(function(i,s,o,g,r,a,m){i['GoogleAnalyticsObject']=r;i[r]=i[r]||function(){
	(i[r].q=i[r].q||[]).push(arguments)},i[r].l=1*new Date();a=s.createElement(o),
	m=s.getElementsByTagName(o)[0];a.async=1;a.src=g;m.parentNode.insertBefore(a,m)
	})(window,document,'script','https://www.google-analytics.com/analytics.js','ga');
	ga('create', 'UA-165292629-1', 'auto');
	
	ga('send', 'pageview');
}
</script>




    </body>
</html>
